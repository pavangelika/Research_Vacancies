<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vacancy Report by Month and Role - {{ current_date }}</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Vacancy Report by Professional Role (Monthly)</h1>
    <p class="report-date">Generated on: <strong>{{ current_date }}</strong></p>

    <div class="tabs">
        {% for role in roles %}
        <button class="tab-button" onclick="openTab(event, 'tab-{{ loop.index }}')">{{ role.id }}</button>
        {% endfor %}
    </div>

    {% for role in roles %}
    <div id="tab-{{ loop.index }}" class="tab-content">
        <h2>{{ role.name }} (ID: {{ role.id }})</h2>
        <table>
            <thead>
                <tr>
                    <th>Месяц</th>
                    <th>Всего вакансий</th>
                    <th>Архивных</th>
                    <th>Активных</th>
                </tr>
            </thead>
            <tbody>
                {% for entry in role.monthly %}
                <tr>
                    <td>{{ entry.month }}</td>
                    <td>{{ entry.total }}</td>
                    <td>{{ entry.archived }}</td>
                    <td>{{ entry.active }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endfor %}

    <script>
        function openTab(evt, tabId) {
            var i, tabcontent, tabbuttons;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tabbuttons = document.getElementsByClassName("tab-button");
            for (i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].className = tabbuttons[i].className.replace(" active", "");
            }
            document.getElementById(tabId).style.display = "block";
            evt.currentTarget.className += " active";
        }

        document.addEventListener("DOMContentLoaded", function() {
            var firstTab = document.getElementsByClassName("tab-button")[0];
            if (firstTab) firstTab.click();
        });
    </script>
</body>
</html>